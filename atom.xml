<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Jeremy Haouan Zhang</title>
  
  <subtitle>Action is the foundational key to all success.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://github.com/JeremyZhaler/haoxuan.github.io/"/>
  <updated>2018-07-17T21:47:46.657Z</updated>
  <id>https://github.com/JeremyZhaler/haoxuan.github.io/</id>
  
  <author>
    <name>Jeremy Haoxuan Zhang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hello World</title>
    <link href="https://github.com/JeremyZhaler/haoxuan.github.io/17/07/2018/hello-world/"/>
    <id>https://github.com/JeremyZhaler/haoxuan.github.io/17/07/2018/hello-world/</id>
    <published>2018-07-17T07:44:41.264Z</published>
    <updated>2018-07-17T21:47:46.657Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><p>’‘’bash</p><p>hello world</p><p>‘’’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nihao</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Wechat Subscription Account Scraping</title>
    <link href="https://github.com/JeremyZhaler/haoxuan.github.io/10/01/2018/wechat-public-account-scraping/"/>
    <id>https://github.com/JeremyZhaler/haoxuan.github.io/10/01/2018/wechat-public-account-scraping/</id>
    <published>2018-01-09T22:48:35.000Z</published>
    <updated>2018-07-21T00:56:03.606Z</updated>
    
    <content type="html"><![CDATA[<p> Wechat is a most popular social application in China. The data from subscription accounts based on Wechat is very valuable for the accounts runner and advertisement owner. The data we will scrap including attributes: Artical_Title, Artical_Content, Artical_Views, Artical Times. At the end, I will store them into MangoDB. The language I uesed are Python and Node.js.</p><p>##Prepare</p><p>I  use MacOS system and Python 3.6.3. Use Pip to install request, json,time,csv</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Use selenium to control Chrome to simulate browser action</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">import redis</span><br><span class="line">import json</span><br><span class="line">import re</span><br><span class="line">import random</span><br><span class="line">import time</span><br><span class="line">from selenium import webdriver</span><br><span class="line">import time</span><br><span class="line">import csv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">post = &#123;&#125;</span><br><span class="line">driver = webdriver.Chrome(executable_path=<span class="string">'/Users/jeremyzhang/Downloads/chromedriver'</span>)</span><br><span class="line">driver.get(<span class="string">'https://mp.weixin.qq.com/'</span>)</span><br><span class="line">time.sleep(2)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"./*//input[@name='account']"</span>).clear()</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"./*//input[@name='account']"</span>).send_keys(<span class="string">'########'</span>)   <span class="comment">##your username</span></span><br><span class="line"><span class="comment">#send keys value should be the id of your wechat id</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">"./*//input[@name='password']"</span>).clear()</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"./*//input[@name='password']"</span>).send_keys(<span class="string">'#######'</span>)   <span class="comment">##your password</span></span><br><span class="line"><span class="comment">#send keys value should be your password</span></span><br><span class="line"><span class="comment"># Click remember me</span></span><br><span class="line">time.sleep(5)</span><br><span class="line">driver.find_element_by_xpath(<span class="string">"./*//a[@title='点击登录']"</span>).click()</span><br><span class="line"><span class="comment"># scan the code</span></span><br><span class="line">time.sleep(20)</span><br><span class="line">driver.get(<span class="string">'https://mp.weixin.qq.com/'</span>)</span><br><span class="line">cookie_items = driver.get_cookies()</span><br><span class="line"><span class="keyword">for</span> cookie_item <span class="keyword">in</span> cookie_items:</span><br><span class="line">    post[cookie_item[<span class="string">'name'</span>]] = cookie_item[<span class="string">'value'</span>]</span><br><span class="line">cookie_str = json.dumps(post)</span><br><span class="line">with open(<span class="string">'cookie.txt'</span>, <span class="string">'w+'</span>, encoding=<span class="string">'utf-8'</span>) as f:</span><br><span class="line">    f.write(cookie_str)</span><br><span class="line"></span><br><span class="line"><span class="comment">#add header</span></span><br><span class="line">gzlist = [<span class="string">'yq_Butler'</span>]</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://mp.weixin.qq.com'</span></span><br><span class="line">header = header = &#123;</span><br><span class="line">    <span class="string">"HOST"</span>: <span class="string">"mp.weixin.qq.com"</span>,</span><br><span class="line">    <span class="string">"User_Agent"</span>: <span class="string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">with open(<span class="string">'cookie.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) as f:</span><br><span class="line">    cookie = f.read()</span><br><span class="line">cookies = json.loads(cookie)</span><br><span class="line">response = requests.get(url=url, cookies=cookies)</span><br><span class="line">token = re.findall(r<span class="string">'token=(\d+)'</span>, str(response.url))[0]</span><br><span class="line"><span class="keyword">for</span> query <span class="keyword">in</span> gzlist:</span><br><span class="line">    query_id = &#123;</span><br><span class="line">        <span class="string">'action'</span>: <span class="string">'search_biz'</span>,</span><br><span class="line">        <span class="string">'token'</span> : token,</span><br><span class="line">        <span class="string">'lang'</span>: <span class="string">'zh_CN'</span>,</span><br><span class="line">        <span class="string">'f'</span>: <span class="string">'json'</span>,</span><br><span class="line">        <span class="string">'ajax'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'random'</span>: random.random(),</span><br><span class="line">        <span class="string">'query'</span>: <span class="string">'dianping_sydney'</span>,</span><br><span class="line">        <span class="comment"># 'kebeiquan' is a wechat id</span></span><br><span class="line">        <span class="string">'begin'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'count'</span>: <span class="string">'5'</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    search_url = <span class="string">'https://mp.weixin.qq.com/cgi-bin/searchbiz?'</span></span><br><span class="line">    search_response = requests.get(search_url, cookies=cookies, headers=header, params=query_id)</span><br><span class="line">    lists = search_response.json().get(<span class="string">'list'</span>)[0]</span><br><span class="line">    fakeid = lists.get(<span class="string">'fakeid'</span>)</span><br><span class="line">    query_id_data = &#123;</span><br><span class="line">        <span class="string">'token'</span>: token,</span><br><span class="line">        <span class="string">'lang'</span>: <span class="string">'zh_CN'</span>,</span><br><span class="line">        <span class="string">'f'</span>: <span class="string">'json'</span>,</span><br><span class="line">        <span class="string">'ajax'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'random'</span>: random.random(),</span><br><span class="line">        <span class="string">'action'</span>: <span class="string">'list_ex'</span>,</span><br><span class="line">        <span class="string">'begin'</span>: <span class="string">'0'</span>,</span><br><span class="line">        <span class="string">'count'</span>: <span class="string">'5'</span>,</span><br><span class="line">        <span class="string">'query'</span>: <span class="string">''</span>,</span><br><span class="line">        <span class="string">'fakeid'</span>: fakeid,</span><br><span class="line">        <span class="string">'type'</span>: <span class="string">'9'</span></span><br><span class="line">    &#125;</span><br><span class="line">    appmsg_url = <span class="string">'https://mp.weixin.qq.com/cgi-bin/appmsg?'</span></span><br><span class="line">    appmsg_response = requests.get(appmsg_url, cookies=cookies, headers=header, params=query_id_data)</span><br><span class="line">    max_num = appmsg_response.json().get(<span class="string">'app_msg_cnt'</span>)</span><br><span class="line">    num = int(int(max_num) / 5)</span><br><span class="line">    begin = 250</span><br><span class="line">    <span class="keyword">while</span> num + 1 &gt; 0 :</span><br><span class="line">        query_id_data = &#123;</span><br><span class="line">            <span class="string">'token'</span>: token,</span><br><span class="line">            <span class="string">'lang'</span>: <span class="string">'zh_CN'</span>,</span><br><span class="line">            <span class="string">'f'</span>: <span class="string">'json'</span>,</span><br><span class="line">            <span class="string">'ajax'</span>: <span class="string">'1'</span>,</span><br><span class="line">            <span class="string">'random'</span>: random.random(),</span><br><span class="line">            <span class="string">'action'</span>: <span class="string">'list_ex'</span>,</span><br><span class="line">            <span class="string">'begin'</span>: <span class="string">'&#123;&#125;'</span>.format(str(begin)),</span><br><span class="line">            <span class="string">'count'</span>: <span class="string">'5'</span>,</span><br><span class="line">            <span class="string">'query'</span>: <span class="string">''</span>,</span><br><span class="line">            <span class="string">'fakeid'</span>: fakeid,</span><br><span class="line">            <span class="string">'type'</span>: <span class="string">'9'</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'next page###################'</span>,begin)</span><br><span class="line">        query_fakeid_response = requests.get(appmsg_url, cookies=cookies, headers=header, params=query_id_data)</span><br><span class="line">        fakeid_list = query_fakeid_response.json().get(<span class="string">'app_msg_list'</span>)</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> fakeid_list:</span><br><span class="line">            <span class="built_in">print</span>(item.get(<span class="string">'link'</span>))</span><br><span class="line">            url = [item.get(<span class="string">'link'</span>)]</span><br><span class="line">        num -= 1</span><br><span class="line">        begin = int(begin)</span><br><span class="line">        begin+=5</span><br><span class="line">        time.sleep(8)</span><br><span class="line"><span class="built_in">print</span> (url)</span><br><span class="line"></span><br><span class="line">c = open(<span class="string">'url1.csv'</span>,<span class="string">'w'</span>)</span><br><span class="line">writer=csv.writer(c)</span><br><span class="line">writer.writerow(url)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt; Wechat is a most popular social application in China. The data from subscription accounts based on Wechat is very valuable for the accou
      
    
    </summary>
    
    
      <category term="Data scraping" scheme="https://github.com/JeremyZhaler/haoxuan.github.io/tags/Data-scraping/"/>
    
  </entry>
  
  <entry>
    <title>hello world</title>
    <link href="https://github.com/JeremyZhaler/haoxuan.github.io/17/07/2017/test/"/>
    <id>https://github.com/JeremyZhaler/haoxuan.github.io/17/07/2017/test/</id>
    <published>2017-07-17T07:50:03.000Z</published>
    <updated>2018-07-17T21:50:09.659Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to this page!</p><h2 id="Quick-start"><a href="#Quick-start" class="headerlink" title="Quick start"></a>Quick start</h2><h3 id="let’s-begin-with-this"><a href="#let’s-begin-with-this" class="headerlink" title="let’s begin with this"></a>let’s begin with this</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>more info: github</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to this page!&lt;/p&gt;
&lt;h2 id=&quot;Quick-start&quot;&gt;&lt;a href=&quot;#Quick-start&quot; class=&quot;headerlink&quot; title=&quot;Quick start&quot;&gt;&lt;/a&gt;Quick start&lt;/h2&gt;&lt;h3 id=&quot;
      
    
    </summary>
    
    
  </entry>
  
</feed>
